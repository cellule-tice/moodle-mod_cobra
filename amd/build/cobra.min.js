define ("mod_cobra/cobra",["jquery","core/log","core/ajax","core/templates","core/notification"],function(a,b,c,d,e){var i,j,k;return{initUi:function initUi(){if(a("body").hasClass("drawer-open-left")){a("body").removeClass("drawer-open-left");a("#nav-drawer").attr("aria-hidden","true");a("#nav-drawer").addClass("closed");a("button[aria-controls=\"nav-drawer\"]").trigger("click")}},initData:function initData(a){i=a;j=JSON.parse(i)},modFormTriggers:function modFormTriggers(){var b=a("#id_updatelanguage"),c=a("#id_language"),d=a("#id_corpusorder"),e=a("#id_selectcollection"),f=a("#id_collection"),g=a("#id_text"),h=a("#id_name");c.on("change",function(){var a=c.find("option:selected").text();if("EN"==a){d.val(j.en)}else if("NL"==a){d.val(j.nl)}b.trigger("click")});f.on("change",function(){e.trigger("click")});g.on("change",function(){if(""==h.val()){h.val(a("#id_text :selected").text())}})},entryOnClick:function entryOnClick(){a(".lemma").on("click",function(){a(".clicked").removeClass("clicked");a(".emphasize").removeClass("emphasize");var b=a(this).attr("name");a(".lemma[name="+b+"]").addClass("emphasize");a(this).removeClass("emphasize");a(this).addClass("clicked");f(b,!1)});a(".expression").on("click",function(){a(".clicked").removeClass("clicked");a(".emphasize").removeClass("emphasize");var b=a(this).attr("name");a(".expression[name="+b+"]").addClass("emphasize");a(this).prevAll("span.expression").each(function(){if(a(this).attr("name")==b){a(this).removeClass("emphasize");a(this).addClass("clicked");return!0}else{return!1}});a(this).nextAll("span.expression").each(function(){if(a(this).attr("name")==b){a(this).removeClass("emphasize");a(this).addClass("clicked");return!0}else{return!1}});a(this).removeClass("emphasize");a(this).addClass("clicked");f(b,!0)})},concordanceOnClick:function concordanceOnClick(){a("#details").on("click",".cc_source",function(){g(a(this))})},textGlossaryActions:function textGlossaryActions(){var b=c.call([{methodname:"mod_cobra_load_glossary",args:{textid:j.text,courseid:j.course,userid:j.user}}]);b[0].done(function(a){k=a;h()}).fail(e.exception);a("#details").on("click",".glossaryadd",function(){var b=a(this).prev().text(),f=c.call([{methodname:"mod_cobra_add_to_glossary",args:{lingentity:b,textid:j.text,course:j.course,userid:j.user}}]);f[0].done(function(c){k.push(c);k.sort(function(c,a){if(c.entry.toLowerCase()<a.entry.toLowerCase()){return-1}if(c.entry.toLowerCase()>a.entry.toLowerCase()){return 1}return 0});var f=[];f.lingentity=b;f.iconclass="inglossary";f.add=!1;d.render("mod_cobra/glossaryiconcell",f).done(function(b){a("#displayOnClic").find("tr:first th:first img").replaceWith(b)}).fail(e.exception);h()}).fail(e.exception)});a("#myglossary").on("click",".glossaryremove",function(){var b=a(this).prev().text(),f=c.call([{methodname:"mod_cobra_remove_from_glossary",args:{lingentity:b,course:j.course,userid:j.user}}]);f[0].done(function(c){k.forEach(function(a,b){if(parseInt(a.lingentity)===c.lingentity){k.splice(b,1)}});if(a("#displayOnClic").find("tr:first th:first span").text()==b){var f=[];f.lingentity=b;f.iconclass="glossaryadd";f.add=!0;d.render("mod_cobra/glossaryiconcell",f).done(function(b){a("#displayOnClic").find("tr:first th:first img").replaceWith(b)}).fail(e.exception)}h()}).fail(e.exception)})},myGlossaryActions:function myGlossaryActions(){a("#myglossary").on("click",".glossaryremove",function(){var b=a(this).find("span:first").text(),d=a(this),f=c.call([{methodname:"mod_cobra_remove_from_glossary",args:{lingentity:b,course:j.course,userid:j.user}}]);f[0].done(function(c){if(c.lingentity==b){if(a(d).hasClass("inDisplay")){a(d.parent().remove())}}}).fail(e.exception)})},demoapikey:function demoapikey(){a("#requestapikey").on("click",function(){var b=c.call([{methodname:"mod_cobra_get_demo_api_key",args:{}}]);b[0].done(function(b){a("#id_s_mod_cobra_apikey").val(b.apikey)}).fail(e.exception);a(this).prop("disabled",!0)})}};function f(b,f){a("#full_concordance").hide();var g=c.call([{methodname:"mod_cobra_get_entry",args:{conceptid:b,isexpr:f,params:i}}]);g[0].done(function(b){if("bilingual"==j.examples){b.bilingual=!0}d.render("mod_cobra/entrydetails",b).done(function(b){a("#details").html(b)}).fail(e.exception)}).fail(e.exception)}function g(b){var f=a("#full_concordance"),g=b.attr("name"),h=c.call([{methodname:"mod_cobra_get_full_concordance",args:{idconcordance:g}}]);h[0].done(function(a){if("bilingual"==j.examples){a.bilingual=!0}d.render("mod_cobra/fullconcordance",a).done(function(b){f.html(b);f.removeClass();f.addClass(a.type);f.show()}).fail(e.exception)}).fail(e.exception)}function h(){var b=[];b.entries=k;b.cmid=j.cmid;b.course=j.course;d.render("mod_cobra/intextglossary",b).done(function(b){a("#glossary").replaceWith(b);a("#glossary").css("height",a("#cobratext").css("height"))}).fail(e.exception)}});
//# sourceMappingURL=cobra.min.js.map
